<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Inline Attachment by Rovak</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Inline Attachment</h1>
      <h2 class="project-tagline">Embed images inside textareas</h2>
      <a href="https://github.com/Rovak/InlineAttachment" class="btn">View on GitHub</a>
      <a href="https://github.com/Rovak/InlineAttachment/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/Rovak/InlineAttachment/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="inline-attachment-131--" class="anchor" href="#inline-attachment-131--" aria-hidden="true"><span class="octicon octicon-link"></span></a>Inline Attachment 1.3.1 <a href="http://travis-ci.org/Rovak/InlineAttachment"><img src="https://api.travis-ci.org/Rovak/InlineAttachment.png?branch=master" alt="Master Branch Build Status"></a> <img src="http://stillmaintained.com/Rovak/InlineAttachment.png" alt="project status">
</h1>

<p>Adds upload functionality to a textarea or CodeMirror instance by either drag-dropping or pasting (only in chrome) an image inside it.</p>

<p>It mimics the comment system on issues which is used on Github.</p>

<p><img src="https://f.cloud.github.com/assets/21/678/248aac6a-40a2-11e2-9a76-fd59ded28bbe.gif" alt="demo"></p>

<h2>
<a id="download" class="anchor" href="#download" aria-hidden="true"><span class="octicon octicon-link"></span></a>Download</h2>

<p>The most recent minified versions can be found <a href="http://data.razko.nl/projects/inlineattachment/latest/">here</a></p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p><strong>Configuration</strong></p>

<p>All versions can be configured using the following options:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-c">/**</span>
<span class="pl-c">     * URL which handles the data</span>
<span class="pl-c">     */</span>
    uploadUrl<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>upload_attachment.php<span class="pl-pds">'</span></span>,

    <span class="pl-c">/**</span>
<span class="pl-c">     * Name of the POST field where the file will be sent.</span>
<span class="pl-c">     * Defaults to 'file'.</span>
<span class="pl-c">     */</span>
    uploadFieldName<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>file<span class="pl-pds">'</span></span>,

    <span class="pl-c">/**</span>
<span class="pl-c">     * Name of the field from the response where the file can be downloaded.</span>
<span class="pl-c">     * Defaults to 'filename'</span>
<span class="pl-c">     */</span>
    downloadFieldName<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>file<span class="pl-pds">'</span></span>,

    <span class="pl-c">// List of allowed MIME types</span>
    allowedTypes<span class="pl-k">:</span> [
        <span class="pl-s"><span class="pl-pds">'</span>image/jpeg<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>image/png<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>image/jpg<span class="pl-pds">'</span></span>,
        <span class="pl-s"><span class="pl-pds">'</span>image/gif<span class="pl-pds">'</span></span>
    ],

    <span class="pl-c">/**</span>
<span class="pl-c">     * Will be inserted on a drop or paste event</span>
<span class="pl-c">     */</span>
    progressText<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>![Uploading file...]()<span class="pl-pds">'</span></span>,

    <span class="pl-c">/**</span>
<span class="pl-c">     * When a file has successfully been uploaded the last inserted text</span>
<span class="pl-c">     * will be replaced by the urlText, the {filename} tag will be replaced</span>
<span class="pl-c">     * by the filename that has been returned by the server</span>
<span class="pl-c">     */</span>
    urlText<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>![file]({filename})<span class="pl-pds">"</span></span>,

    <span class="pl-c">/**</span>
<span class="pl-c">     * Error message for default error handler</span>
<span class="pl-c">     */</span>
    errorText<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Error uploading file<span class="pl-pds">"</span></span>,

    <span class="pl-c">/**</span>
<span class="pl-c">     * Extra parameters which will be send as POST data when sending a file</span>
<span class="pl-c">     */</span>
    extraParams<span class="pl-k">:</span> {},

    <span class="pl-c">/**</span>
<span class="pl-c">     * When a file is received by drag-drop or paste</span>
<span class="pl-c">     *</span>
<span class="pl-c">     * <span class="pl-k">@param</span> {Blob} file</span>
<span class="pl-c">     */</span>
    <span class="pl-en">onReceivedFile</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">file</span>) {},

    <span class="pl-c">/**</span>
<span class="pl-c">     * When a file has succesfully been uploaded</span>
<span class="pl-c">     *</span>
<span class="pl-c">     * <span class="pl-k">@param</span> {Object} json JSON data returned from the server</span>
<span class="pl-c">     */</span>
    <span class="pl-en">onUploadedFile</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">json</span>) {},

    <span class="pl-c">/**</span>
<span class="pl-c">     * Custom error handler. Runs after removing the placeholder text and before the alert().</span>
<span class="pl-c">     * Return false from this function to prevent the alert dialog.</span>
<span class="pl-c">     *</span>
<span class="pl-c">     * <span class="pl-k">@return</span> {Boolean} when false is returned it will prevent default error behavior</span>
<span class="pl-c">     */</span>
    <span class="pl-en">customErrorHandler</span><span class="pl-k">:</span> <span class="pl-k">function</span>() { <span class="pl-k">return</span> <span class="pl-c1">true</span>; },

    <span class="pl-c">/**</span>
<span class="pl-c">     * Custom upload handler, must return false to prevent default handler.</span>
<span class="pl-c">     * Can be used to send file via custom transport(like socket.io)</span>
<span class="pl-c">     *</span>
<span class="pl-c">     * <span class="pl-k">@param</span> {Blob} file</span>
<span class="pl-c">     * <span class="pl-k">@return</span> {Boolean} when false is returned it will prevent default upload behavior</span>
<span class="pl-c">     */</span>
    <span class="pl-en">customUploadHandler</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">file</span>) { <span class="pl-k">return</span> <span class="pl-c1">true</span>; }

    <span class="pl-c">/**</span>
<span class="pl-c">     * Data processor after upload a file</span>
<span class="pl-c">     *</span>
<span class="pl-c">     * <span class="pl-k">@param</span> {Object} data JSON data returned from the server</span>
<span class="pl-c">     * <span class="pl-k">@return</span> {Object} modified object</span>
<span class="pl-c">     */</span>
    <span class="pl-en">dataProcessor</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">data</span>) { <span class="pl-k">return</span> data; }
}</pre></div>

<h3>
<a id="jquery" class="anchor" href="#jquery" aria-hidden="true"><span class="octicon octicon-link"></span></a>jQuery</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-en">$</span>(<span class="pl-s"><span class="pl-pds">'</span>textarea<span class="pl-pds">'</span></span>).<span class="pl-en">inlineattach</span>(options);</pre></div>

<h3>
<a id="codemirror" class="anchor" href="#codemirror" aria-hidden="true"><span class="octicon octicon-link"></span></a>CodeMirror</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> editor <span class="pl-k">=</span> <span class="pl-smi">CodeMirror</span>.<span class="pl-en">fromTextArea</span>(<span class="pl-smi">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">"</span>textarea_editor<span class="pl-pds">"</span></span>));
<span class="pl-smi">inlineAttach</span>.<span class="pl-en">attachToCodeMirror</span>(editor, options);</pre></div>

<h3>
<a id="angularjs" class="anchor" href="#angularjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>AngularJS</h3>

<p>Textarea</p>

<div class="highlight highlight-text-html-basic"><pre>&lt;<span class="pl-ent">textarea</span>
    <span class="pl-e">inlineattach</span>
    <span class="pl-e">inlineattach-progress-text</span>=<span class="pl-s"><span class="pl-pds">"</span>Sending...<span class="pl-pds">"</span></span>
    <span class="pl-e">inlineattach-on-received-file</span>=<span class="pl-s"><span class="pl-pds">"</span>receivedFile<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">textarea</span>&gt;</pre></div>

<p>Controller</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">textAreaCtrl</span>(<span class="pl-smi">$scope</span>) {
    <span class="pl-c1">$scope</span>.<span class="pl-en">receivedFile</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">file</span>) {
        <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>received file!<span class="pl-pds">'</span></span>, file);
    }
}</pre></div>

<h3>
<a id="input-field" class="anchor" href="#input-field" aria-hidden="true"><span class="octicon octicon-link"></span></a>Input field</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-smi">inlineAttach</span>.<span class="pl-en">attachToInput</span>(<span class="pl-smi">document</span>.<span class="pl-c1">getElementById</span>(<span class="pl-s"><span class="pl-pds">'</span>inputfield<span class="pl-pds">'</span></span>), options);</pre></div>

<h2>
<a id="handling-image-uploads" class="anchor" href="#handling-image-uploads" aria-hidden="true"><span class="octicon octicon-link"></span></a>Handling image uploads</h2>

<p>The Demo folder contains an example in PHP on how to handle uploads.</p>

<h2>
<a id="build" class="anchor" href="#build" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build</h2>

<p>To build the project you need node, npm and grunt installed. These tools can be installed on Ubuntu as follows:</p>

<p>Follow the Node.js guide: <a href="https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager">Node.js installation</a></p>

<p>Go to the project folder and run the following:</p>

<div class="highlight highlight-source-shell"><pre>npm install
grunt</pre></div>

<p>This should build the project and the files will appear in the <code>dist/</code> folder</p>

<h2>
<a id="changelog" class="anchor" href="#changelog" aria-hidden="true"><span class="octicon octicon-link"></span></a>Changelog</h2>

<p><a href="https://github.com/Rovak/InlineAttachment/releases">See Github releases</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/Rovak/InlineAttachment">Inline Attachment</a> is maintained by <a href="https://github.com/Rovak">Rovak</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
